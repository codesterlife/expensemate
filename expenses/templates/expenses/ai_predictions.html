{% extends 'base.html' %}

{% block title %}AI Predictions - ExpenseMate{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h2><i class="bi bi-magic"></i> AI-Powered Spending Predictions</h2>
        <p class="text-muted">Get insights about your future spending using AI</p>
    </div>
</div>

<div class="row">
    <div class="col-md-8 mx-auto">
        <div class="card">
            <div class="card-body">
                <form method="post">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label for="prediction_type" class="form-label">What would you like to know?</label>
                        <select name="prediction_type" id="prediction_type" class="form-select">
                            <option value="next_month">Predict next month's spending</option>
                            <option value="category_insights">Category-wise insights</option>
                            <option value="budget_advice">Budget recommendations</option>
                            <option value="custom">Custom question</option>
                        </select>
                    </div>
                    
                    <div class="mb-3" id="customQuestion" style="display: none;">
                        <label for="custom_question" class="form-label">Your Question</label>
                        <textarea name="custom_question" id="custom_question" class="form-control" rows="3" 
                                  placeholder="E.g., How can I reduce my food expenses?"></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="bi bi-stars"></i> Generate AI Insights
                    </button>
                </form>
                
                {% if prediction %}
                <div class="mt-4 p-4 bg-light rounded">
                    <h5><i class="bi bi-lightbulb text-warning"></i> AI Insights</h5>
                    <div class="mt-3">
                        {{ prediction|safe }}
                    </div>
                </div>
                {% endif %}
                
                {% if error %}
                <div class="alert alert-danger mt-4">
                    <i class="bi bi-exclamation-triangle"></i> {{ error }}
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.getElementById('prediction_type').addEventListener('change', function() {
        const customQuestion = document.getElementById('customQuestion');
        if (this.value === 'custom') {
            customQuestion.style.display = 'block';
        } else {
            customQuestion.style.display = 'none';
        }
    });
</script>
{% endblock %}
